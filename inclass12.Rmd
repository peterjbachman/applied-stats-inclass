---
title: "Applied Statistical Programming - Projects"
date: "2/23/2022"
author: "Amaan, Alex, Patrick, Peter"
header-includes:
   - \usepackage{amsmath}
   - \usepackage{geometry}
   - \usepackage{hyperref}
   - \usepackage{setspace}
   - \usepackage{hyperref}
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\textbf{Write the R code to answer the following questions. Write the code, and then show what the computer returns when that code is run. Thoroughly comment your solutions.}

You have until the beginning of class 2/28 at 10:00am to complete the assignment below. You may use R, but not any online R documentation. Submit the Rmarkdown and the knitted PDF to Canvas. Have one group member submit the activity with all group members listed at the top.

\section*{Project Management}

In this exercise, you will plot a Twitter user's activity for a single day distinguishing between their novel content and their retweets. You will load a data set, modify it, and generate figures in a project environment. Download the \texttt{Tweets.csv} file from Canvas, and complete the following tasks in your project environment.

\begin{enumerate}
  \item Subset the data to the user \texttt{a\_silberberg} for tweets occurring on November 4, 2015.
  \item Write the subset data as a CSV file into a \texttt{Data} sub-folder of your project.
  \item Generate a \texttt{plot()} where the Y-axis is a count of Twitter activity and the X-axis is the time of day the activity took place. Use the \texttt{IsRetweet} variable to distinguish whether the activity was a retweet or new content generated by the user. Your plot must have a title, labeled axes, and a legend for the two types of Twitter activity ("Tweet" versus "Retweet").
  \item Write the plot as a PDF to a \texttt{Figures} sub-folder of your project.
\end{enumerate}

You will need to generate count variables to make this plot. You will also need to use the \texttt{lubridate} package to parse time from the full date-time stamp. Assuming you have already subsetted the data to only focus on the user \texttt{a\_silberberg}, you can create a new variable in the data for the time with the following code. You will also need to wrap \texttt{newtime} in a \texttt{as.POSIXct()} statement so R knows how to handle the time data.

```{r tidy=TRUE}
library(lubridate)
library(plyr)
df <- read.csv("Tweets.csv")

only_a_Silberberg <- df[df$ScreenName == "a_silberberg", ]

dates <- as.POSIXct(only_a_Silberberg$CreatedTime, format = "%Y-%m-%d %H:%M:%S")
# Extra the day from the full time stamp
days <- format(dates, format = "%Y-%m-%d")
# Subset the data again so only tweets on November 4 are included.
newData <- only_a_Silberberg[which(days == "2015-11-04"), ]
# Make a new variable in the data that is only the time of the tweet, not the day
newData$newtime <- as.numeric(format(as.POSIXct(newData$CreatedTime, format = "%Y-%m-%d %H:%M:%S"),
  format = "%H"
))

tweets <- newData[newData$IsRetweet == 0, ]
retweets <- newData[newData$IsRetweet == 1, ]

countsTweets <- ddply(tweets, .(newtime), nrow)
countsRetweets <- ddply(retweets, .(newtime), nrow)

pdf("./plots/tweets.pdf")

plot(
  x = countsRetweets$newtime,
  y = countsRetweets$V1,
  type = "l",
  col = "blue",
  xlab = "Hour of the Day",
  main = "Tweets for 'a_silberberg'",
  ylab = "Number of tweets per hour"
)
points(
  x = countsTweets$newtime,
  y = countsTweets$V1,
  type = "l",
  col = "red"
)
legend(1, 11, legend = c("Retweets", "Tweets"), col = c("blue", "red"), lty = 1, cex = 0.8)

dev.off()
```

